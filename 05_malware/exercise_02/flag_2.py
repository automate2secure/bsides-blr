import pyshark


def extract_http_body(pcap_file):
    # Open the PCAP file using PyShark
    cap = pyshark.FileCapture(pcap_file, display_filter="http")

    # Iterate through the packets
    for packet in cap:
        try:
            if "HTTP" in packet and hasattr(packet.http, "response_code"):
                if hasattr(packet.http, "file_data"):
                    print(str(packet.http.file_data))
        except AttributeError:
            continue


# Replace with your pcap file path
pcap_file = "./ctf_traffic.pcap"
extract_http_body(pcap_file)
